(()=>{"use strict";var i,e,t,s,o,r={9234:(i,e,t)=>{t.d(e,{CZ:()=>a,Is:()=>o,U8:()=>h,fb:()=>s,mR:()=>r,yy:()=>l});const s=async i=>new Promise((e=>setTimeout(e,i))),o=async i=>new Int8Array(await(await fetch(i)).arrayBuffer()),r=async i=>(await fetch(i)).text();function h(i){let e=0n;for(let t=0;t<i.length;t++)e=(e<<8n)+BigInt(i[t]);return e}function a(i){const e=[];for(;i>0n;)e.unshift(Number(255n&i)),i>>=8n;return new Uint8Array(e)}function l(i,e,t){let s=1n;for(;e>0n;)e%2n===1n&&(s=s*i%t),i=i*i%t,e>>=1n;return s}},9073:(i,e,t)=>{t.a(i,(async(i,e)=>{try{var s=t(4702),o=t(2901),r=t(9234),h=t(1069),a=t(7604),l=t(8370),n=t(3867),c=t(1673),f=t(1122),d=t(2682),v=t(8950),w=t(4544),m=t(1651);class i extends l.A{static shouldDrawBorders=!1;static shouldDrawLabels=!0;db=null;startX=3200;startZ=3200;sizeX=1280;sizeZ=1344;originX=2240;originZ=2752;maxLabelCount=1e3;labelCount=0;labelText=[];labelX=[];labelY=[];labelFont=[];floorcolUnderlay=[0];floorcolOverlay=[0];underlayTiles=[];overlayTiles=[];overlayInfo=[];locWalls=[];locMapscenes=[];locMapfunction=[];objTiles=[];npcTiles=[];imageMapscene=[];imageMapfunction=[];imageMapdot0=null;imageMapdot1=null;imageMapdot2=null;imageMapdot3=null;b12=null;floormapColors=[];redraw=!0;redrawTimer=0;lastMouseClickX=-1;lastMouseClickY=-1;lastOffsetX=-1;lastOffsetZ=-1;shouldClearEmptyTiles=!1;keyNames=["General Store","Sword Shop","Magic Shop","Axe Shop","Helmet Shop","Bank","Quest Start","Amulet Shop","Mining Site","Furnace","Anvil","Combat Training","Dungeon","Staff Shop","Platebody Shop","Platelegs Shop","Scimitar Shop","Archery Shop","Shield Shop","Altar","Herbalist","Jewelery","Gem Shop","Crafting Shop","Candle Shop","Fishing Shop","Fishing Spot","Clothes Shop","Apothecary","Silk Trader","Kebab Seller","Pub/Bar","Mace Shop","Tannery","Rare Trees","Spinning Wheel","Food Shop","Cookery Shop","???","Water Source","Cooking Range","Skirt Shop","Potters Wheel","Windmill","Mining Shop","Chainmail Shop","Silver Shop","Fur Trader","Spice Shop"];keyX=5;keyY=13;keyWidth=140;keyHeight=470;showKey=!1;keyPage=0;lastKeyPage=0;currentKeyHover=-1;lastKeyHover=0;currentKey=0;flashTimer=0;visibleMapFunctionsX=new Int32Array(2e3);visibleMapFunctionsY=new Int32Array(2e3);visibleMapFunctions=new Int32Array(2e3);activeMapFunctionX=new Int32Array(2e3);activeMapFunctionZ=new Int32Array(2e3);activeMapFunctions=new Int32Array(2e3);activeMapFunctionCount=0;imageOverview=null;imageOverviewHeight=200;imageOverviewWidth=this.imageOverviewHeight*this.sizeX/this.sizeZ|0;overviewX=635-this.imageOverviewWidth-5;overviewY=503-this.imageOverviewHeight-20;showOverview=!1;colorInactiveBorderTL=8943445;colorInactive=7824964;colorInactiveBorderBR=6706483;colorActiveBorderTL=11141120;colorActive=10027008;colorActiveBorderBR=8912896;zoom=4;targetZoom=4;offsetX=this.startX-this.originX;offsetZ=this.originZ+this.sizeZ-this.startZ;load=async()=>{await s.A.load(await(await fetch("bz2.wasm")).arrayBuffer()),this.db=new w.A(await w.A.openDatabase());const i=await this.loadWorldmap();await this.showProgress(100,"Please wait... Rendering Map");const e=new h.A(i.read("labels.dat"));this.labelCount=e.g2;for(let i=0;i<this.labelCount;i++)this.labelText[i]=e.gjstr,this.labelX[i]=e.g2,this.labelY[i]=e.g2,this.labelFont[i]=e.g1;const t=new h.A(i.read("floorcol.dat")),o=t.g2;for(let i=0;i<o;i++)this.floorcolUnderlay[i+1]=t.g4,this.floorcolOverlay[i+1]=t.g4;const r=new h.A(i.read("underlay.dat"));this.underlayTiles=new n.Iy(this.sizeX,this.sizeZ,0),this.readUnderlayData(r);const a=new h.A(i.read("overlay.dat"));this.overlayTiles=new n.Iy(this.sizeX,this.sizeZ,0),this.overlayInfo=new n.Iy(this.sizeX,this.sizeZ,0),this.readOverlayData(a);const l=new h.A(i.read("loc.dat"));this.locWalls=new n.Iy(this.sizeX,this.sizeZ,0),this.locMapscenes=new n.Iy(this.sizeX,this.sizeZ,0),this.locMapfunction=new n.Iy(this.sizeX,this.sizeZ,0),this.readLocData(l);const m=new h.A(i.read("obj.dat"));this.objTiles=new n.Iy(this.sizeX,this.sizeZ,!1),this.readObjData(m);const u=new h.A(i.read("npc.dat"));this.npcTiles=new n.Iy(this.sizeX,this.sizeZ,!1),this.readNpcData(u);try{for(let e=0;e<50;e++)this.imageMapscene[e]=c.A.fromArchive(i,"mapscene",e)}catch(i){}try{for(let e=0;e<50;e++)this.imageMapfunction[e]=f.A.fromArchive(i,"mapfunction",e)}catch(i){}this.imageMapdot0=f.A.fromArchive(i,"mapdots",0),this.imageMapdot1=f.A.fromArchive(i,"mapdots",1),this.imageMapdot2=f.A.fromArchive(i,"mapdots",2),this.imageMapdot3=f.A.fromArchive(i,"mapdots",3),this.b12=d.A.fromArchive(i,"b12"),this.floormapColors=new n.Iy(this.sizeX,this.sizeZ,0),this.averageUnderlayColors(),this.shouldClearEmptyTiles&&this.clearEmptyTiles(),this.imageOverview=new f.A(this.imageOverviewWidth,this.imageOverviewHeight),this.imageOverview.bind(),this.drawMap(0,0,this.sizeX,this.sizeZ,0,0,this.imageOverviewWidth,this.imageOverviewHeight),v.A.drawRect(0,0,this.imageOverviewWidth,this.imageOverviewHeight,0),v.A.drawRect(1,1,this.imageOverviewWidth-2,this.imageOverviewHeight-2,this.colorInactiveBorderTL),this.drawArea.bind()};draw=async()=>{if(this.redraw){this.redraw=!1,this.redrawTimer=0,v.A.clear();const i=this.offsetX-(635/this.zoom|0),e=this.offsetZ-(503/this.zoom|0),t=this.offsetX+(635/this.zoom|0),s=this.offsetZ+(503/this.zoom|0);if(this.drawMap(i,e,t,s,0,0,635,503),this.showOverview&&(this.imageOverview?.blitOpaque(this.overviewX,this.overviewY),v.A.fillRectAlpha(this.overviewX+this.imageOverviewWidth*i/this.sizeX|0,this.overviewY+this.imageOverviewHeight*e/this.sizeZ|0,(t-i)*this.imageOverviewWidth/this.sizeX|0,(s-e)*this.imageOverviewHeight/this.sizeZ|0,16711680,128),v.A.drawRect(this.overviewX+this.imageOverviewWidth*i/this.sizeX|0,this.overviewY+this.imageOverviewHeight*e/this.sizeZ|0,(t-i)*this.imageOverviewWidth/this.sizeX|0,(s-e)*this.imageOverviewHeight/this.sizeZ|0,16711680),this.flashTimer>0&&this.flashTimer%10<5))for(let i=0;i<this.activeMapFunctionCount;i++)if(this.activeMapFunctions[i]==this.currentKey){const e=this.overviewX+this.imageOverviewWidth*this.activeMapFunctionX[i]/this.sizeX|0,t=this.overviewY+this.imageOverviewHeight*this.activeMapFunctionZ[i]/this.sizeZ|0;v.A.fillCircle(e,t,2,16776960,256)}if(this.showKey){this.drawString(this.keyX,this.keyY,this.keyWidth,18,10066329,7829367,5592405,"Prev page"),this.drawString(this.keyX,this.keyY+18,this.keyWidth,this.keyHeight-36,10066329,7829367,5592405,""),this.drawString(this.keyX,this.keyY+this.keyHeight-18,this.keyWidth,18,10066329,7829367,5592405,"Next page");let i=this.keyY+3+18;for(let e=0;e<25;e++){if(e+this.lastKeyPage<this.imageMapfunction.length&&e+this.lastKeyPage<this.keyNames.length){if("???"===this.keyNames[e+this.lastKeyPage])continue;this.imageMapfunction[e+this.lastKeyPage].draw(this.keyX+3,i),this.b12?.drawString(this.keyX+21,i+14,this.keyNames[e+this.lastKeyPage],0);let t=16777215;this.currentKeyHover==e+this.lastKeyPage&&(t=12298922),this.flashTimer>0&&this.flashTimer%10<5&&this.currentKey==e+this.lastKeyPage&&(t=16776960),this.b12?.drawString(this.keyX+20,i+13,this.keyNames[e+this.lastKeyPage],t)}i+=17}}this.drawString(this.overviewX,this.overviewY+this.imageOverviewHeight,this.imageOverviewWidth,18,this.colorInactiveBorderTL,this.colorInactive,this.colorInactiveBorderBR,"Overview"),this.drawString(this.keyX,this.keyY+this.keyHeight,this.keyWidth,18,this.colorInactiveBorderTL,this.colorInactive,this.colorInactiveBorderBR,"Key"),3==this.targetZoom?this.drawString(170,471,50,30,this.colorActiveBorderTL,this.colorActive,this.colorActiveBorderBR,"37%"):this.drawString(170,471,50,30,this.colorInactiveBorderTL,this.colorInactive,this.colorInactiveBorderBR,"37%"),4==this.targetZoom?this.drawString(230,471,50,30,this.colorActiveBorderTL,this.colorActive,this.colorActiveBorderBR,"50%"):this.drawString(230,471,50,30,this.colorInactiveBorderTL,this.colorInactive,this.colorInactiveBorderBR,"50%"),6==this.targetZoom?this.drawString(290,471,50,30,this.colorActiveBorderTL,this.colorActive,this.colorActiveBorderBR,"75%"):this.drawString(290,471,50,30,this.colorInactiveBorderTL,this.colorInactive,this.colorInactiveBorderBR,"75%"),8==this.targetZoom?this.drawString(350,471,50,30,this.colorActiveBorderTL,this.colorActive,this.colorActiveBorderBR,"100%"):this.drawString(350,471,50,30,this.colorInactiveBorderTL,this.colorInactive,this.colorInactiveBorderBR,"100%")}this.redrawTimer--,this.redrawTimer<=0&&(this.drawArea?.draw(0,0),this.redrawTimer=50)};refresh=async()=>{this.redrawTimer=0};update=async()=>{1==this.actionKey[1]&&(this.offsetX=this.offsetX-16/this.zoom|0,this.redraw=!0),1==this.actionKey[2]&&(this.offsetX=this.offsetX+16/this.zoom|0,this.redraw=!0),1==this.actionKey[3]&&(this.offsetZ=this.offsetZ-16/this.zoom|0,this.redraw=!0),1==this.actionKey[4]&&(this.offsetZ=this.offsetZ+16/this.zoom|0,this.redraw=!0);let i=1;for(;i>0;)i=this.pollKey(),49==i?(this.targetZoom=3,this.redraw=!0):50==i?(this.targetZoom=4,this.redraw=!0):51==i?(this.targetZoom=6,this.redraw=!0):52==i?(this.targetZoom=8,this.redraw=!0):107==i||75==i?(this.showKey=!this.showKey,this.redraw=!0):111!=i&&79!=i||(this.showOverview=!this.showOverview,this.redraw=!0);if(1==this.mouseClickButton&&(this.lastMouseClickX=this.mouseClickX,this.lastMouseClickY=this.mouseClickY,this.lastOffsetX=this.offsetX,this.lastOffsetZ=this.offsetZ,this.mouseClickX>170&&this.mouseClickX<220&&this.mouseClickY>471&&this.mouseClickY<503?(this.targetZoom=3,this.lastMouseClickX=-1):this.mouseClickX>230&&this.mouseClickX<280&&this.mouseClickY>471&&this.mouseClickY<503?(this.targetZoom=4,this.lastMouseClickX=-1):this.mouseClickX>290&&this.mouseClickX<340&&this.mouseClickY>471&&this.mouseClickY<503?(this.targetZoom=6,this.lastMouseClickX=-1):this.mouseClickX>350&&this.mouseClickX<400&&this.mouseClickY>471&&this.mouseClickY<503?(this.targetZoom=8,this.lastMouseClickX=-1):this.mouseClickX>this.keyX&&this.mouseClickY>this.keyY+this.keyHeight&&this.mouseClickX<this.keyX+this.keyWidth&&this.mouseClickY<503?(this.showKey=!this.showKey,this.lastMouseClickX=-1):this.mouseClickX>this.overviewX&&this.mouseClickY>this.overviewY+this.imageOverviewHeight&&this.mouseClickX<this.overviewX+this.imageOverviewWidth&&this.mouseClickY<503&&(this.showOverview=!this.showOverview,this.lastMouseClickX=-1),this.showKey&&(this.mouseClickX>this.keyX&&this.mouseClickY>this.keyY&&this.mouseClickX<this.keyX+this.keyWidth&&this.mouseClickY<this.keyY+this.keyHeight&&(this.lastMouseClickX=-1),this.mouseClickX>this.keyX&&this.mouseClickY>this.keyY&&this.mouseClickX<this.keyX+this.keyWidth&&this.mouseClickY<this.keyY+18?this.keyPage=0:this.mouseClickX>this.keyX&&this.mouseClickY>this.keyY+this.keyHeight-18&&this.mouseClickX<this.keyX+this.keyWidth&&this.mouseClickY<this.keyY+this.keyHeight&&(this.keyPage=25)),this.redraw=!0),this.showKey){if(this.currentKeyHover=-1,this.mouseX>this.keyX&&this.mouseX<this.keyX+this.keyWidth){let i=this.keyY+21+5;for(let e=0;e<25;e++)e+this.lastKeyPage<this.keyNames.length&&"???"!==this.keyNames[e+this.lastKeyPage]&&(this.mouseY>=i&&this.mouseY<i+17&&(this.currentKeyHover=e+this.lastKeyPage,1==this.mouseClickButton&&(this.currentKey=e+this.lastKeyPage,this.flashTimer=50)),i+=17)}this.currentKeyHover!=this.lastKeyHover&&(this.lastKeyHover=this.currentKeyHover,this.redraw=!0)}if((1==this.mouseButton||1==this.mouseClickButton)&&this.showOverview){let i=this.mouseClickX,e=this.mouseClickY;1==this.mouseButton&&(i=this.mouseX,e=this.mouseY),i>this.overviewX&&e>this.overviewY&&i<this.overviewX+this.imageOverviewWidth&&e<this.overviewY+this.imageOverviewHeight&&(this.offsetX=(i-this.overviewX)*this.sizeX/this.imageOverviewWidth|0,this.offsetZ=(e-this.overviewY)*this.sizeZ/this.imageOverviewHeight|0,this.lastMouseClickX=-1,this.redraw=!0)}1==this.mouseButton&&-1!=this.lastMouseClickX&&(this.offsetX=this.lastOffsetX+(2*(this.lastMouseClickX-this.mouseX)/this.targetZoom|0),this.offsetZ=this.lastOffsetZ+(2*(this.lastMouseClickY-this.mouseY)/this.targetZoom|0),this.redraw=!0),this.zoom<this.targetZoom&&(this.redraw=!0,this.zoom+=this.zoom/30,this.zoom>this.targetZoom&&(this.zoom=this.targetZoom)),this.zoom>this.targetZoom&&(this.redraw=!0,this.zoom-=this.zoom/30,this.zoom<this.targetZoom&&(this.zoom=this.targetZoom)),this.lastKeyPage<this.keyPage&&(this.redraw=!0,this.lastKeyPage++),this.lastKeyPage>this.keyPage&&(this.redraw=!0,this.lastKeyPage--),this.flashTimer>0&&(this.redraw=!0,this.flashTimer--);const e=this.offsetX-(635/this.zoom|0),t=this.offsetZ-(503/this.zoom|0),s=this.offsetX+(635/this.zoom|0),o=this.offsetZ+(503/this.zoom|0);e<48&&(this.offsetX=48+(635/this.zoom|0)),t<48&&(this.offsetZ=48+(503/this.zoom|0)),s>this.sizeX-48&&(this.offsetX=this.sizeX-48-(635/this.zoom|0)),o>this.sizeZ-48&&(this.offsetZ=this.sizeZ-48-(503/this.zoom|0))};async loadWorldmap(){let i=await(this.db?.cacheload("worldmap.dat"));if(i)return new o.A(i);let e=5;for(;!i;){await this.showProgress(0,"Requesting map");try{console.log(`${m.K.httpAddress}/worldmap.jag`),i=await(0,r.Is)(`${m.K.httpAddress}/worldmap.jag`)}catch(t){i=void 0;for(let i=e;i>0;i--)await this.showProgress(0,`Error loading - Will retry in ${i} secs.`),await(0,r.fb)(1e3);e*=2,e>60&&(e=60)}}return await(this.db?.cachesave("worldmap.dat",i)),new o.A(i)}drawString(i,e,t,s,o,r,h,a){i=Math.trunc(i),e=Math.trunc(e),t=Math.trunc(t),s=Math.trunc(s),v.A.drawRect(i,e,t,s,0);const l=i+1,n=e+1,c=t-2,f=s-2;v.A.fillRect(l,n,c,f,r),v.A.drawHorizontalLine(l,n,o,c),v.A.drawVerticalLine(l,n,o,f),v.A.drawHorizontalLine(l,n+f-1,h,c),v.A.drawVerticalLine(l+c-1,n,h,f),this.b12?.drawStringCenter(l+c/2+1,n+f/2+1+4,a,0),this.b12?.drawStringCenter(l+c/2,n+f/2+4,a,16777215)}clearEmptyTiles(){for(let i=0;i<this.sizeX;i++)for(let e=0;e<this.sizeZ;e++)0==this.underlayTiles[i][e]&&0==this.overlayTiles[i][e]&&(this.floormapColors[i][e]=0)}averageUnderlayColors(){const i=this.sizeX,e=this.sizeZ,t=new n.FO(e,0);for(let s=5;s<i-5;s++){for(let i=0;i<e;i++)t[i]+=this.floorcolUnderlay[this.underlayTiles[s+5][i]]-this.floorcolUnderlay[this.underlayTiles[s-5][i]];if(s>10&&s<i-10){let i=0,o=0,r=0;for(let h=5;h<e-5;h++){const e=t[h+5],a=t[h-5];i+=(e>>20)-(a>>20),o+=(e>>10&1023)-(a>>10&1023),r+=(1023&e)-(1023&a),r>0&&(this.floormapColors[s][h]=this.convertHsl(i/8533,o/8533,r/8533))}}}}readUnderlayData(i){for(;i.available>0;){const e=64*i.g1-this.originX,t=64*i.g1-this.originZ;if(e>0&&t>0&&e+64<this.sizeX&&t+64<this.sizeZ)for(let s=0;s<64;s++){let o=this.sizeZ-t-1;for(let t=-64;t<0;t++)this.underlayTiles[e+s][o--]=i.g1}else i.pos+=4096}}readOverlayData(i){for(;i.available>0;){const e=64*i.g1-this.originX,t=64*i.g1-this.originZ;if(e>0&&t>0&&e+64<this.sizeX&&t+64<this.sizeZ)for(let s=0;s<64;s++){let o=this.sizeZ-t-1;for(let t=-64;t<0;t++){const t=i.g1;0===t?this.overlayTiles[s+e][o--]=0:(this.overlayInfo[s+e][o]=i.g1,this.overlayTiles[s+e][o--]=this.floorcolOverlay[t])}}else for(let e=-4096;e<0;e++)0!=i.g1&&i.g1}}readLocData(i){for(;i.available>0;){const e=64*i.g1-this.originX,t=64*i.g1-this.originZ;if(e>0&&t>0&&e+64<this.sizeX&&t+64<this.sizeZ)for(let s=0;s<64;s++){let o=this.sizeZ-t-1;for(let t=-64;t<0;t++)for(;;){const t=i.g1;if(0===t){o--;break}t<29?this.locWalls[s+e][o]=t:t<160?this.locMapscenes[s+e][o]=t-28:(this.locMapfunction[s+e][o]=t-159,this.activeMapFunctions[this.activeMapFunctionCount]=t-160,this.activeMapFunctionX[this.activeMapFunctionCount]=s+e,this.activeMapFunctionZ[this.activeMapFunctionCount]=o,this.activeMapFunctionCount++)}}else for(let e=0;e<64;e++){let e=0;for(let t=-64;t<0;t++)do{e=i.g1}while(0!=e)}}}readObjData(i){for(;i.available>0;){const e=64*i.g1-this.originX,t=64*i.g1-this.originZ;if(e>0&&t>0&&e+64<this.sizeX&&t+64<this.sizeZ)for(let s=0;s<64;s++){let o=this.sizeZ-t-1;for(let t=-64;t<0;t++)this.objTiles[s+e][o--]=1==i.g1}else i.pos+=4096}}readNpcData(i){for(;i.available>0;){const e=64*i.g1-this.originX,t=64*i.g1-this.originZ;if(e>0&&t>0&&e+64<this.sizeX&&t+64<this.sizeZ)for(let s=0;s<64;s++){let o=this.sizeZ-t-1;for(let t=-64;t<0;t++)this.npcTiles[s+e][o--]=1==i.g1}else i.pos+=4096}}convertHsl(i,e,t){let s=t,o=t,r=t;if(0!==e){let h;h=t<.5?t*(e+1):t+e-t*e;const a=2*t-h;let l=i+.3333333333333333;l>1&&l--;let n=i-.3333333333333333;n<0&&n++,s=6*l<1?a+6*(h-a)*l:2*l<1?h:3*l<2?a+(h-a)*(.6666666666666666-l)*6:a,o=6*i<1?a+6*(h-a)*i:2*i<1?h:3*i<2?a+(h-a)*(.6666666666666666-i)*6:a,r=6*n<1?a+6*(h-a)*n:2*n<1?h:3*n<2?a+(h-a)*(.6666666666666666-n)*6:a}return(256*s<<16)+(256*o<<8)+(256*r|0)}drawMap(e,t,s,o,r,h,a,l){const n=s-e,c=o-t,f=(a-r<<16)/n|0,d=(l-h<<16)/c|0;for(let i=0;i<n;i++){let s=f*i>>16,o=f*(i+1)>>16;const a=o-s;if(!(a<=0)){s+=r,o+=r;for(let r=0;r<c;r++){let l=d*r>>16,n=d*(r+1)>>16;const c=n-l;if(c<=0)continue;l+=h,n+=h;const f=this.overlayTiles[i+e][r+t];if(0===f)v.A.fillRect(s,l,o-s,n-l,this.floormapColors[i+e][r+t]);else{const o=this.overlayInfo[i+e][r+t],h=252&o;0==h||a<=1||c<=1?v.A.fillRect(s,l,a,c,f):this.drawSmoothEdges(v.A.pixels,l*v.A.width2d+s,this.floormapColors[i+e][r+t],f,a,c,h>>2,3&o)}}}}if(s-e>a-r)return;let w=0;for(let i=0;i<n;i++){let s=f*i>>16,o=f*(i+1)>>16;const a=o-s;if(!(a<=0)){s+=r,o+=r;for(let r=0;r<c;r++){let l=d*r>>16,n=d*(r+1)>>16;const c=n-l;if(c<=0)continue;l+=h,n+=h;let f=255&this.locWalls[i+e][r+t];if(0!=f){let i,e;i=1==a?s:o-1,e=1==c?l:n-1;let t=13421772;if((f>=5&&f<=8||f>=13&&f<=16||f>=21&&f<=24)&&(t=13369344,f-=4),27!=f&&28!=f||(t=13369344,f-=2),1==f)v.A.drawVerticalLine(s,l,t,c);else if(2==f)v.A.drawHorizontalLine(s,l,t,a);else if(3==f)v.A.drawVerticalLine(i,l,t,c);else if(4==f)v.A.drawHorizontalLine(s,e,t,a);else if(9==f)v.A.drawVerticalLine(s,l,16777215,c),v.A.drawHorizontalLine(s,l,t,a);else if(10==f)v.A.drawVerticalLine(i,l,16777215,c),v.A.drawHorizontalLine(s,l,t,a);else if(11==f)v.A.drawVerticalLine(i,l,16777215,c),v.A.drawHorizontalLine(s,e,t,a);else if(12==f)v.A.drawVerticalLine(s,l,16777215,c),v.A.drawHorizontalLine(s,e,t,a);else if(17==f)v.A.drawHorizontalLine(s,l,t,1);else if(18==f)v.A.drawHorizontalLine(i,l,t,1);else if(19==f)v.A.drawHorizontalLine(i,e,t,1);else if(20==f)v.A.drawHorizontalLine(s,e,t,1);else if(25==f)for(let i=0;i<c;i++)v.A.drawHorizontalLine(s+i,e-i,t,1);else if(26==f)for(let i=0;i<c;i++)v.A.drawHorizontalLine(s+i,l+i,t,1)}const m=this.locMapscenes[i+e][r+t];0!=m&&this.imageMapscene[m-1].clip(s-a/2,l-c/2,2*a,2*c);const u=this.locMapfunction[i+e][r+t];0!=u&&(this.visibleMapFunctions[w]=u-1,this.visibleMapFunctionsX[w]=s+a/2,this.visibleMapFunctionsY[w]=l+c/2,w++)}}}for(let i=0;i<n;i++){let s=f*i>>16,o=f*(i+1)>>16;if(!(o-s<=0)){s+=r,o+=r;for(let o=0;o<c;o++){let r=d*o>>16,a=d*(o+1)>>16;a-r<=0||(r+=h,a+=h,this.objTiles[i+e][o+t]&&this.imageMapdot0?.draw(s,r))}}}for(let i=0;i<n;i++){let s=f*i>>16,o=f*(i+1)>>16;if(!(o-s<=0)){s+=r,o+=r;for(let o=0;o<c;o++){let r=d*o>>16,a=d*(o+1)>>16;a-r<=0||(r+=h,a+=h,this.npcTiles[i+e][o+t]&&this.imageMapdot1?.draw(s,r))}}}for(let i=0;i<w;i++)this.imageMapfunction[this.visibleMapFunctions[i]].draw(this.visibleMapFunctionsX[i]-7,this.visibleMapFunctionsY[i]-7);if(this.flashTimer>0)for(let i=0;i<w;i++)this.visibleMapFunctions[i]==this.currentKey&&(this.imageMapfunction[this.visibleMapFunctions[i]].draw(this.visibleMapFunctionsX[i]-7,this.visibleMapFunctionsY[i]-7),this.flashTimer%10<5&&(v.A.fillCircle(this.visibleMapFunctionsX[i],this.visibleMapFunctionsY[i],15,16776960,128),v.A.fillCircle(this.visibleMapFunctionsX[i],this.visibleMapFunctionsY[i],7,16777215,256)));if(this.zoom==this.targetZoom&&i.shouldDrawLabels,i.shouldDrawBorders)for(let i=this.originX/64;i<(this.originX+this.sizeX)/64;i++)for(let n=this.originZ/64;n<(this.originZ+this.sizeZ)/64;n++){let c=64*i,f=64*n;c-=this.originX,f=this.originZ+this.sizeZ-f;const d=r+(a-r)*(c-e)/(s-e)|0,w=h+(l-h)*(f-64-t)/(o-t)|0,m=r+(a-r)*(c+64-e)/(s-e)|0,u=h+(l-h)*(f-t)/(o-t)|0;v.A.drawRect(d,w,16777215,m-d,u-w),this.b12?.drawStringRight(m-5,u-5,i+"_"+n,16777215,!1),33==i&&n>=71&&n<=73?this.b12?.drawStringCenter((m+d)/2,(u+w)/2,"u_pass",16711680):i>=32&&i<=34&&n>=70&&n<=74&&this.b12?.drawStringCenter((m+d)/2,(u+w)/2,"u_pass",16776960)}}drawSmoothEdges(i,e,t,s,o,r,h,a){const l=v.A.width2d-o;if(9==h?(h=1,a=a+1&3):10==h?(h=1,a=a+3&3):11==h&&(h=8,a=a+3&3),1==h){if(0==a)for(let h=0;h<r;h++){for(let r=0;r<o;r++)i[e++]=r<=h?s:t;e+=l}else if(1==a)for(let h=r-1;h>=0;h--){for(let r=0;r<o;r++)i[e++]=r<=h?s:t;e+=l}else if(2==a)for(let h=0;h<r;h++){for(let r=0;r<o;r++)i[e++]=r>=h?s:t;e+=l}else if(3==a)for(let h=r-1;h>=0;h--){for(let r=0;r<o;r++)i[e++]=r>=h?s:t;e+=l}}else if(2==h){if(0==a)for(let h=r-1;h>=0;h--){for(let r=0;r<o;r++)i[e++]=r<=h>>1?s:t;e+=l}else if(1==a)for(let h=0;h<r;h++){for(let r=0;r<o;r++)i[e++]=r>=h<<1?s:t;e+=l}else if(2==a)for(let h=0;h<r;h++){for(let r=o-1;r>=0;r--)i[e++]=r<=h>>1?s:t;e+=l}else if(3==a)for(let h=r-1;h>=0;h--){for(let r=o-1;r>=0;r--)i[e++]=r>=h<<1?s:t;e+=l}}else if(3==h){if(0==a)for(let h=r-1;h>=0;h--){for(let r=o-1;r>=0;r--)i[e++]=r<=h>>1?s:t;e+=l}else if(1==a)for(let h=r-1;h>=0;h--){for(let r=0;r<o;r++)i[e++]=r>=h<<1?s:t;e+=l}else if(2==a)for(let h=0;h<r;h++){for(let r=0;r<o;r++)i[e++]=r<=h>>1?s:t;e+=l}else if(3==a)for(let h=0;h<r;h++){for(let r=o-1;r>=0;r--)i[e++]=r>=h<<1?s:t;e+=l}}else if(4==h){if(0==a)for(let h=r-1;h>=0;h--){for(let r=0;r<o;r++)i[e++]=r>=h>>1?s:t;e+=l}else if(1==a)for(let h=0;h<r;h++){for(let r=0;r<o;r++)i[e++]=r<=h<<1?s:t;e+=l}else if(2==a)for(let h=0;h<r;h++){for(let r=o-1;r>=0;r--)i[e++]=r>=h>>1?s:t;e+=l}else if(3==a)for(let h=r-1;h>=0;h--){for(let r=o-1;r>=0;r--)i[e++]=r<=h<<1?s:t;e+=l}}else if(5==h){if(0==a)for(let h=r-1;h>=0;h--){for(let r=o-1;r>=0;r--)i[e++]=r>=h>>1?s:t;e+=l}else if(1==a)for(let h=r-1;h>=0;h--){for(let r=0;r<o;r++)i[e++]=r<=h<<1?s:t;e+=l}else if(2==a)for(let h=0;h<r;h++){for(let r=0;r<o;r++)i[e++]=r>=h>>1?s:t;e+=l}else if(3==a)for(let h=0;h<r;h++){for(let r=o-1;r>=0;r--)i[e++]=r<=h<<1?s:t;e+=l}}else if(6==h){if(0==a)for(let h=0;h<r;h++){for(let r=0;r<o;r++)i[e++]=r<=o/2?s:t;e+=l}else if(1==a)for(let h=0;h<r;h++){for(let a=0;a<o;a++)i[e++]=h<=r/2?s:t;e+=l}else if(2==a)for(let h=0;h<r;h++){for(let r=0;r<o;r++)i[e++]=r>=o/2?s:t;e+=l}else if(3==a)for(let h=0;h<r;h++){for(let a=0;a<o;a++)i[e++]=h>=r/2?s:t;e+=l}}else if(7==h){if(0==a)for(let h=0;h<r;h++){for(let a=0;a<o;a++)i[e++]=a<=h-r/2?s:t;e+=l}else if(1==a)for(let h=r-1;h>=0;h--){for(let a=0;a<o;a++)i[e++]=a<=h-r/2?s:t;e+=l}else if(2==a)for(let h=r-1;h>=0;h--){for(let a=o-1;a>=0;a--)i[e++]=a<=h-r/2?s:t;e+=l}else if(3==a)for(let h=0;h<r;h++){for(let a=o-1;a>=0;a--)i[e++]=a<=h-r/2?s:t;e+=l}}else if(8==h)if(0==a)for(let h=0;h<r;h++){for(let a=0;a<o;a++)i[e++]=a>=h-r/2?s:t;e+=l}else if(1==a)for(let h=r-1;h>=0;h--){for(let a=0;a<o;a++)i[e++]=a>=h-r/2?s:t;e+=l}else if(2==a)for(let h=r-1;h>=0;h--){for(let a=o-1;a>=0;a--)i[e++]=a>=h-r/2?s:t;e+=l}else if(3==a)for(let h=0;h<r;h++){for(let a=o-1;a>=0;a--)i[e++]=a>=h-r/2?s:t;e+=l}}getTitleScreenState(){return 0}isChatBackInputOpen(){return!1}isShowSocialInput(){return!1}getChatInterfaceId(){return-1}getViewportInterfaceId(){return-1}}await(0,a.w)(),(new i).run().then((()=>{})),window.onkeydown=function(i){return!(" "===i.key&&i.target===document.body)},e()}catch(i){e(i)}}),1)},123:(i,e,t)=>{function s(i,e){window._tinyMidiPlay&&window._tinyMidiPlay(i,e/256)}function o(){window._tinyMidiStop&&window._tinyMidiStop()}t.d(e,{cs:()=>s,qI:()=>o})}},h={};function a(i){var e=h[i];if(void 0!==e)return e.exports;var t=h[i]={exports:{}};return r[i](t,t.exports,a),t.exports}a.m=r,i="function"==typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",e="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",t="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",s=i=>{i&&i.d<1&&(i.d=1,i.forEach((i=>i.r--)),i.forEach((i=>i.r--?i.r++:i())))},a.a=(o,r,h)=>{var a;h&&((a=[]).d=-1);var l,n,c,f=new Set,d=o.exports,v=new Promise(((i,e)=>{c=e,n=i}));v[e]=d,v[i]=i=>(a&&i(a),f.forEach(i),v.catch((i=>{}))),o.exports=v,r((o=>{var r;l=(o=>o.map((o=>{if(null!==o&&"object"==typeof o){if(o[i])return o;if(o.then){var r=[];r.d=0,o.then((i=>{h[e]=i,s(r)}),(i=>{h[t]=i,s(r)}));var h={};return h[i]=i=>i(r),h}}var a={};return a[i]=i=>{},a[e]=o,a})))(o);var h=()=>l.map((i=>{if(i[t])throw i[t];return i[e]})),n=new Promise((e=>{(r=()=>e(h)).r=0;var t=i=>i!==a&&!f.has(i)&&(f.add(i),i&&!i.d&&(r.r++,i.push(r)));l.map((e=>e[i](t)))}));return r.r?n:h()}),(i=>(i?c(v[t]=i):n(d),s(a)))),a&&a.d<0&&(a.d=0)},o=[],a.O=(i,e,t,s)=>{if(!e){var r=1/0;for(c=0;c<o.length;c++){for(var[e,t,s]=o[c],h=!0,l=0;l<e.length;l++)(!1&s||r>=s)&&Object.keys(a.O).every((i=>a.O[i](e[l])))?e.splice(l--,1):(h=!1,s<r&&(r=s));if(h){o.splice(c--,1);var n=t();void 0!==n&&(i=n)}}return i}s=s||0;for(var c=o.length;c>0&&o[c-1][2]>s;c--)o[c]=o[c-1];o[c]=[e,t,s]},a.d=(i,e)=>{for(var t in e)a.o(e,t)&&!a.o(i,t)&&Object.defineProperty(i,t,{enumerable:!0,get:e[t]})},a.o=(i,e)=>Object.prototype.hasOwnProperty.call(i,e),a.p="/",(()=>{a.b=document.baseURI||self.location.href;var i={540:0};a.O.j=e=>0===i[e];var e=(e,t)=>{var s,o,[r,h,l]=t,n=0;if(r.some((e=>0!==i[e]))){for(s in h)a.o(h,s)&&(a.m[s]=h[s]);if(l)var c=l(a)}for(e&&e(t);n<r.length;n++)o=r[n],a.o(i,o)&&i[o]&&i[o][0](),i[o]=0;return a.O(c)},t=self.webpackChunk_2004scape_client=self.webpackChunk_2004scape_client||[];t.forEach(e.bind(null,0)),t.push=e.bind(null,t.push.bind(t))})();var l=a.O(void 0,[489],(()=>a(9073)));l=a.O(l)})();