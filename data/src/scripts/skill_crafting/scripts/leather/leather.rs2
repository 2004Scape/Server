[if_button,crafting_leather:com_88] @craft_leather(leather_body);
[if_button,crafting_leather:com_89] @craft_leather(leather_gloves);
[if_button,crafting_leather:com_90] @craft_leather(leather_boots);
[if_button,crafting_leather:com_91] @craft_leather(leather_vambraces);
[if_button,crafting_leather:com_97] @craft_leather(leather_chaps);
[if_button,crafting_leather:com_99] @craft_leather(coif);
[if_button,crafting_leather:com_100] @craft_leather(leather_cowl);
[if_button,crafting_leather:com_110] if_close;

[opheldu,needle]
switch_obj (last_useitem)
{
    case thread : ~chatplayer(neutral,"Perhaps I should use a needle with a piece of leather instead.");
    case leather :
        if_setobject(crafting_leather:com_100, leather_cowl, 180);
        if_opentop(crafting_leather);
    case hardleather : @craft_leather(hardleather_body);
    case greenleather, blueleather, redleather, blackleather : @craft_dhide_interface(last_useslot);
    case default : @nothing_interesting_happens;
};

[opheldu,leather]
if (last_useitem = needle) {
    if_setobject(crafting_leather:com_100, leather_cowl, 180);
    if_opentop(crafting_leather);
}

[opheldu,hardleather]
if (last_useitem = needle) @craft_leather(hardleather_body);

[opheldu,greenleather]
if (last_useitem = needle) @craft_dhide_interface(last_slot);

[opheldu,blueleather]
if (last_useitem = needle) @craft_dhide_interface(last_slot);

[opheldu,redleather]
if (last_useitem = needle) @craft_dhide_interface(last_slot);

[opheldu,blackleather]
if (last_useitem = needle) @craft_dhide_interface(last_slot);

[opheldu,thread]
if (last_useitem = needle) {
    ~chatplayer(neutral,"Perhaps I should use a needle with a piece of leather instead.");
    return;
}


//--- all leather
[label,craft_leather](namedobj $crafting_obj)
//p_stopaction;
def_struct $crafting_struct = oc_param($crafting_obj, crafting_leather_struct);

// check if player has required level
if (stat(crafting) < struct_param($crafting_struct, levelrequired)) {
    ~mesbox(struct_param($crafting_struct, levelfailure));
    return;
}

// check if player has required ingredients
if (inv_total(inv, struct_param($crafting_struct, ingredient)) < struct_param($crafting_struct, ingredient_count)) {
    ~mesbox(struct_param($crafting_struct, processfailure));
    return;
}

// close interface
if_close;

// delete ingredients by the ingredient count
inv_del(inv, struct_param($crafting_struct, ingredient), struct_param($crafting_struct, ingredient_count));

// delete thread if conditions are met
%thread_used = calc(%thread_used + 1);
if (%thread_used > 4) {
    inv_del(inv, thread, 1);
    mes("You use up one of your reels of thread.");
    %thread_used = 0;
}

// give product
inv_add(inv, struct_param($crafting_struct, product), 1);

// give xp
givexp(crafting, struct_param($crafting_struct, productexp));

// display game message
mes(struct_param($crafting_struct, productmessage));
//----------------------------


//--- Not started
[label,craft_dhide_interface](int $last)
return;
//---


/** UNUSED
// crafting leather likely used no weakqueue before 27 September 2004.
// https://oldschool.runescape.wiki/w/Update:Skills,_Duels_and_the_Kalphite
[weakqueue,crafting_leather](int $crafting_exp, namedobj $crafting_product, string $crafting_message, seq $crafting_anim, int $count, int $crafting_ingredient_count, namedobj $crafting_ingredient, string $crafting_productfailure)

//items with a ingredient count of more than 1 have a product fail message
if ($count < 1) {
    return;
}
if ($count < $crafting_ingredient_count) {
    mes($crafting_productfailure);
    return;
}

if (%skill_clock < calc(map_clock + 1)) {
    inv_del(inv, $crafting_ingredient, $crafting_ingredient_count);
    inv_add(inv, $crafting_product, 1);
    givexp(crafting, $crafting_exp);
    mes($crafting_message);
    
    %thread_used = calc(%thread_used + 1);
    if (%thread_used > 4) {
        inv_del(inv, thread, 1);
        mes("You use up one of your reels of thread.");
        %thread_used = 0;
    }
    $count = sub($count, $crafting_ingredient_count);
    %skill_clock = calc(map_clock + 1);
    weakqueue(crafting_leather, 3, $crafting_exp, $crafting_product, $crafting_message, $crafting_anim, $count, $crafting_ingredient_count, $crafting_ingredient, $crafting_productfailure);
}
*/