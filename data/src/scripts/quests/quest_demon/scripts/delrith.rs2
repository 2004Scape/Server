[ai_queue3,delrith](int $arg)
[ai_queue4,delrith](int $arg) gosub(npc_death);
//[ai_opplayer2,delrith] @delrith_attack;

[ai_queue2,delrith](int $damage)
~npc_default_damage($damage);
if (npc_stat(hitpoints) = 0) {
    if (npc_findhero = true) {
          @delrith_death;
          return;
    }
}

[opnpc2,delrith]
if (%demon_progress < ^demon_complete) {
    if (inv_total(inv, silverlight) > 0 & inv_getobj(worn, 3) ! silverlight) {
        mes("Maybe I'd better wield silverlight first.");
        return;
    }

    if ((inv_total(inv, silverlight) < 1 & inv_getobj(worn, 3) ! silverlight)) {
        mes("I'd rather not. He looks scary.");
        return;
    }

    @player_combat_start;
} else {
    mes("You've already done that quest.");
}

// Somehow wire this up once combat is written.
[label,delrith_death]
if (inv_getobj(worn, 3) = silverlight & %demon_progress < ^demon_complete) {
    npc_changetype(weakened_delrith);
    if_close;
    if (p_finduid(uid) = true) {
        ~chatplayer(neutral, "Now what was that incantation again?");
        def_int $option = ~p_choice4("Carlem Gabindo Purchai Zaree Camerinthum", 1, "Purchai Zaree Gabindo Carlem Camerinthum", 2, "Purchai Camerinthum Aber Gabindo Carlem", 3, "Carlem Aber Camerinthum Purchai Gabindo", 4);

        if ($option = 1) {
            ~chatplayer(happy, "Carlem Gabindo Purchai Zaree Camerinthum");
            @demon_slayer_wrong_incantation;
        } else if ($option = 2) {
            ~chatplayer(happy, "Purchai Zaree Gabindo Carlem Camerinthum");
            @demon_slayer_wrong_incantation;
        } else if ($option = 3) {
            ~chatplayer(happy, "Purchai Camerinthum Aber Gabindo Carlem");
            @demon_slayer_wrong_incantation;
        } else if ($option = 4) {
            ~chatplayer(happy, "Carlem Aber Camerinthum Purchai Gabindo");
            @demon_slayer_correct_incantation;
        }
    }
}

[label,demon_slayer_wrong_incantation]
mes("As you chant, Delrith is sucked towards the vortex.");
p_delay(1);
mes("Suddenly, the vortex closes!");
p_delay(1);
npc_changetype(delrith);
mes("That was the wrong incantation");


[label,demon_slayer_correct_incantation]
mes("Delrith is sucked back into the dark dimension from which he came!");
gosub(npc_death);
queue(demon_slayer_complete, 1);
mes("This breaking here?");
